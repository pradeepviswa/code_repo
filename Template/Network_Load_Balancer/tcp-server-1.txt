#!/bin/bash
# Switch to ec2-user home
cd /home/ec2-user

# Create tcp_server.sh
cat > tcp_server.sh << 'EOF'
#!/bin/bash

PORT=6381

echo "Starting TCP server on port $PORT..."
while true; do
    # Listen on TCP port and send a response
    nc -lk -p $PORT -c 'echo "Hello from TCP server!"'
done
EOF

# Make the script executable
chmod +x tcp_server.sh

# Run the TCP server in background
nohup ./tcp_server.sh > tcp_server.log 2>&1 &
